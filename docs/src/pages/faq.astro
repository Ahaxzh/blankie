---
import Layout from "../layouts/Layout.astro";
import { marked } from "marked";

const title = "FAQ";

// Import the markdown file directly
const { Content, getHeadings, rawContent } = await import("../../../FAQ.md");
const headings = await getHeadings();

// Filter out the main h1 title, we only want the questions
const questions = headings.filter((h) => h.depth === 2);

// Split content by headings and parse to HTML
const content = rawContent();
const sections = content.split(/(?=## )/);
const questionContent = Object.fromEntries(
  sections
    .slice(1) // Skip the first section (before first ##)
    .map((section) => {
      const title = section.match(/## (.*)\n/)?.[1] || "";
      const content = section.replace(/## .*\n/, "").trim();
      return [title, marked(content)]; // Parse markdown to HTML
    })
);

// Note: The content of this page is generated from a markdown file. Please do not edit this file directly.
---

<Layout title={title}>
  <main
    class="prose prose-lg dark:prose-invert max-w-5xl mx-auto px-5 pt-28 pb-10"
  >
    <section class="text-skin-base bg-skin-fill">
      <h1 class="text-4xl font-semibold mb-6">Frequently Asked Questions</h1>

      <div class="not-prose">
        <div class="space-y-4">
          {
            questions.map((question) => (
              <details class="group bg-dark-gray rounded-lg faq-details">
                <summary class="flex cursor-pointer items-center gap-1.5 p-4 text-gray-900 text-left">
                  <h2 class="font-medium text-gray-100 grow">
                    {question.text}
                  </h2>
                  <svg
                    class="h-5 w-5 shrink-0 transition duration-300 group-open:-rotate-180 stroke-gray-100"
                    xmlns="http://www.w3.org/2000/svg"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke-width="1.5"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      d="M19.5 8.25l-7.5 7.5-7.5-7.5"
                    />
                  </svg>
                </summary>
                <div class="p-4 pt-0 text-gray-300">
                  <Fragment set:html={questionContent[question.text]} />
                </div>
              </details>
            ))
          }
        </div>
      </div>
    </section>
  </main>
</Layout>
